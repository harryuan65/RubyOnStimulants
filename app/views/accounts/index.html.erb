<%= javascript_include_tag("common/form") %>

<div id="wrap-dropdown-form">
    <div id="dropdown-form">
          <span class="x" onclick="toggleForm()">x</span>
          <div class="wrap-form-title">
            <span class="form-title">Create</span>
          </div>
          <%= form_for @new_purchase_history, url:add_accounts_path(@new_purchase_history),html:{id:"form-ph",name:"form-ph",autocomplete:"off"},remote:true ,method: 'post' do |f| %>
            <%= f.text_field "content"    , placeholder:"What?"   , required:true                               , class:"input text-field"%>
            <%= f.text_field "price"      , placeholder:"Price"   ,required:true                               , class:"input text-field"%>
            <%= f.select "category"       , options_for_select(["Meal","Desert","Drink","Necessity","Other"]) ,{}    , class:"input select"%>
            <%= f.select "currency"       , options_for_select(["NTD","JPY","USD","RMB"]) ,{}                  , class:"input select" %>
            <%= f.text_field "description", placeholder:"Postscript"                                                 ,class:"input text-field" %>
            <%= f.submit "Submit", class:"input submit" %>
          <% end %>
    </div>
</div>

<div id="container-account" class="container">
  <table class="table-account">
      <thead>
        <tr>
          <th class="time">When</th>
          <th class="content">Content</t>
          <th class="price">Price</th>
          <th class="category">Category</th>
          <th class="desc">Desc</th>
          <th class="currency">Currency</th>
          <th class="delete">Delete</th>
        </tr>
      </thead>
      <tbody class="tbody-account">
        <% if @todays_purchase_histories.any?%>
          <% @todays_purchase_histories.each do |record| %>
            <tr id="tr_<%=record.id%>">
              <td class="time" id="<%= record.id %>" onclick="details(this)">
                <%= taipei_time(record.created_at).strftime("%k:%M") %>
              </td>
              <td class="content"><%= record.content %></td>
              <td class="price"><span id="dollar-sign" class="light">$ </span><%= record.price %></td>
              <td class="category"><%= record.category %></td>
              <td class="desc"><%= record.description %></td>
              <td class="currency"><%= record.currency %></td>
              <td class="delete"> <div onclick='delete_history({url:"<%= delete_accounts_path%>", id:"<%= record.id %>"})' > ❌</div></td>
            </tr>
          <% end %>
        <% else %>
          <tr id="none">
            <td>None</td>
          </tr>
        <% end %>
      </tbody>
  </table>
  <div class="wrap-date-and-sum">
    <div class="wrap-date-form">
      <span class="date-text">找日期</span>
      <%= form_tag accounts_path,method:'get',id:"form-date" do%>
        <%= date_field_tag :day,DateTime.now.in_time_zone('Taipei'),class:"input-date account-date" %>
        <%# <%= select_date @day, prefix: :day, class:"select-date", use_two_digit_numbers: true ,date_separator: '/'%>
        <%= submit_tag "Go",class:"btn-date account-date" %>
      <% end %>
    </div>
    <span class="daily-sum-text">本日小計: <span id="dollar-sign">$</span><%= @daily_sum %></span>
  </div>
</div>

<div class="wrap-account-options">
  <div class="account-option">
     <div style="cursor:pointer;" onclick="alert('抱歉，這還沒有功能')">
       <div class="icon-wrap"><%= image_tag("report.png",class:"icon icon-report") %></div>
     </div>
  </div>
  <div class="account-option">
    <div id="dropdown-toggle-account" onclick="toggleForm()">
      <div class="icon-wrap"><%= image_tag("add.png",class:"icon-add") %></div>
    </div>
  </div>
</div>